/* @license GPL-2.0-or-later https://www.drupal.org/licensing/faq */
(function($,Drupal,drupalSettings){Drupal.behaviors.leaflet={attach:function(context,settings){$.each(settings.leaflet,function(m,data){const leaflet_elements=$(once('behaviour-leaflet','#'+data['mapid']));leaflet_elements.each(function(){let map_container=$(this);let mapid=data['mapid'];function loadMap(mapid){if(map_container.data('leaflet')===undefined){map_container.data('leaflet',new Drupal.Leaflet(L.DomUtil.get(mapid),mapid,data.map));if(data.features.length>0)map_container.data('leaflet').add_features(data.features,true);data.lMap=map_container.data('leaflet').lMap;data.markers=map_container.data('leaflet').markers;map_container.data('leaflet').fitBounds();if(!map_container.data('leaflet').start_center&&!map_container.data('leaflet').start_zoom){map_container.data('leaflet').start_center=map_container.data('leaflet').lMap.getCenter();map_container.data('leaflet').start_zoom=map_container.data('leaflet').lMap.getZoom();}Drupal.Leaflet[mapid]=map_container.data('leaflet');if(!Drupal.Leaflet[mapid].geocoder_control&&Drupal.Leaflet.prototype.map_geocoder_control){let mapGeocoderControlDiv=document.createElement('div');Drupal.Leaflet[mapid].geocoder_control=Drupal.Leaflet.prototype.map_geocoder_control(mapGeocoderControlDiv,mapid);Drupal.Leaflet[mapid].geocoder_control.addTo(Drupal.Leaflet[mapid].lMap);let geocoder_settings=drupalSettings.leaflet[mapid].map.settings.geocoder.settings;Drupal.Leaflet.prototype.map_geocoder_control.autocomplete(mapid,geocoder_settings);}if(Drupal.Leaflet[mapid].layer_control)Drupal.Leaflet[mapid].lMap.addControl(Drupal.Leaflet[mapid].layer_control);if(!Drupal.Leaflet[mapid].reset_view_control&&map_container.data('leaflet').map_settings.reset_map&&map_container.data('leaflet').map_settings.reset_map.control){let map_reset_view_options=map_container.data('leaflet').map_settings.reset_map.options?JSON.parse(map_container.data('leaflet').map_settings.reset_map.options):{};map_reset_view_options.latlng=map_container.data('leaflet').start_center;map_reset_view_options.zoom=map_container.data('leaflet').start_zoom;Drupal.Leaflet[mapid].reset_view_control=L.control.resetView(map_reset_view_options).addTo(map_container.data('leaflet').lMap);}if(!Drupal.Leaflet[mapid].map_scale_control&&map_container.data('leaflet').map_settings.map_scale&&map_container.data('leaflet').map_settings.map_scale.control){const map_scale_options=map_container.data('leaflet').map_settings.map_scale.options?JSON.parse(map_container.data('leaflet').map_settings.map_scale.options):{};Drupal.Leaflet[mapid].map_scale_control=L.control.scale(map_scale_options).addTo(map_container.data('leaflet').lMap);}if(!Drupal.Leaflet[mapid].locate_control&&map_container.data('leaflet').map_settings.locate&&map_container.data('leaflet').map_settings.locate.control){let locate_options=map_container.data('leaflet').map_settings.locate.options?JSON.parse(map_container.data('leaflet').map_settings.locate.options):{};Drupal.Leaflet[mapid].locate_control=L.control.locate(locate_options).addTo(map_container.data('leaflet').lMap);if(!data.hasOwnProperty('leaflet_widget')&&map_container.data('leaflet').map_settings.hasOwnProperty('locate')&&map_container.data('leaflet').map_settings.locate.automatic)Drupal.Leaflet[mapid].locate_control.start();}if(!Drupal.Leaflet[mapid].fullscreen_control&&map_container.data('leaflet').map_settings.fullscreen&&map_container.data('leaflet').map_settings.fullscreen.control){let map_fullscreen_options=map_container.data('leaflet').map_settings.fullscreen.options?JSON.parse(map_container.data('leaflet').map_settings.fullscreen.options):{};Drupal.Leaflet[mapid].fullscreen_control=L.control.fullscreen(map_fullscreen_options).addTo(map_container.data('leaflet').lMap);}data.lMap.on('popupopen',function(e){let element=e.popup._contentNode;let content=$('*[data-leaflet-ajax-popup]',element);if(content.length){let url=content.data('leaflet-ajax-popup');Drupal.ajax({url}).execute().done(function(data){e.popup.setContent(data[0].data);Drupal.attachBehaviors(element,drupalSettings);}).fail(function(){e.popup.close();});}if(e.popup._source){let tooltip=e.popup._source.getTooltip();if(tooltip)e.popup._source.getTooltip().setOpacity(0);}});data.lMap.on('popupclose',function(e){if(e.popup._source){let tooltip=e.popup._source.getTooltip();if(tooltip)tooltip.setOpacity(0.9);}});$(document).trigger('leafletMapInit',[data.map,data.lMap,mapid,data.markers]);$(document).trigger('leaflet.map',[data.map,data.lMap,mapid,data.markers]);}}let mapObserver=null;if('IntersectionObserver' in window)mapObserver=new IntersectionObserver(function(entries,observer){for(var i=0;i<entries.length;i++)if(entries[i].isIntersecting){const mapid=entries[i].target.id;loadMap(mapid);}});if(mapObserver&&data.map.settings['map_lazy_load']&&data.map.settings['map_lazy_load']['lazy_load'])mapObserver.observe(this);else loadMap(mapid);});});}};Drupal.Leaflet=function(map_container,mapid,map_definition){this.mapid=mapid;this.map_container=map_container;this.map_definition=map_definition;this.map_settings=this.map_definition.settings;this.bounds=[];this.base_layers={};this.overlays={};this.lMap=null;this.start_center=null;this.start_zoom=null;this.layer_control=null;this.markers={};this.features={};this.initialise(mapid);};Drupal.Leaflet.prototype.initialise=function(mapid){this.lMap=new L.Map(mapid,this.map_settings);let i=0;for(let key in this.map_definition.layers){let layer=this.map_definition.layers[key];layer.layer_type=(typeof layer.layer_type==='undefined')?'base':layer.layer_type;switch(layer.layer_type){case 'overlay':{const overlay_layer=this.create_layer(layer,key);const layer_hidden=(typeof layer.layer_hidden==="undefined")?false:layer.layer_hidden;this.add_overlay(key,overlay_layer,layer_hidden);break;}default:this.add_base_layer(key,layer,i);if(i===0)i++;break;}i++;}if(this.map_settings.center&&this.map_settings.zoom)this.lMap.setView(new L.LatLng(this.map_settings.center.lat,this.map_settings.center.lon),this.map_settings.zoom);else this.lMap.fitWorld();if(this.lMap.zoomControl)this.lMap.zoomControl.setPosition(this.map_settings.zoomControlPosition);new IntersectionObserver((entries,observer)=>{entries.forEach((entry)=>{if(entry.intersectionRatio>0){this.lMap.invalidateSize();observer.disconnect();}});}).observe(this.lMap._container);};Drupal.Leaflet.prototype.initialise_layers_control=function(){let count_layers=function(obj){return Object.keys(obj).length;};if(this.layer_control==null&&((this.map_settings.layerControl&&count_layers(this.base_layers)>1||count_layers(this.overlays)>0))){const base_layers=count_layers(this.base_layers)>1?this.base_layers:[];this.layer_control=new L.Control.Layers(base_layers,[],this.map_settings.layerControlOptions);}};Drupal.Leaflet.prototype.add_base_layer=function(key,definition,i){const base_layer=this.create_layer(definition,key);this.base_layers[key]=base_layer;if(i===0)this.lMap.addLayer(base_layer);if(this.layer_control==null)this.initialise_layers_control();else this.layer_control.addBaseLayer(base_layer,key);};Drupal.Leaflet.prototype.add_overlay=function(label,layer,hidden_layer){if(!hidden_layer)this.lMap.addLayer(layer);this.overlays[label]=layer;if(label&&this.layer_control==null)this.initialise_layers_control();if(label&&this.layer_control)this.layer_control.addOverlay(layer,label);};Drupal.Leaflet.prototype.add_features=function(features,initial){let layers={};for(let i=0;i<features.length;i++){let feature=features[i];let lFeature;if(feature.group){layers[feature['group_label']]=this.create_feature_group();for(let groupKey in feature.features){let groupFeature=feature.features[groupKey];lFeature=this.create_feature(groupFeature);if(lFeature!==undefined){layers[feature['group_label']].addLayer(lFeature);$(document).trigger('leaflet.feature',[lFeature,groupFeature,this,layers]);}}this.add_overlay(feature.group_label,layers[feature['group_label']],feature['disabled']);}else{lFeature=this.create_feature(feature);if(lFeature!==undefined){this.lMap.addLayer(lFeature);$(document).trigger('leaflet.feature',[lFeature,feature,this]);}}}$(document).trigger('leaflet.features',[initial||false,this]);};Drupal.Leaflet.prototype.create_feature_group=function(){return new L.featureGroup();};Drupal.Leaflet.prototype.feature_bind_popup=function(lFeature,feature){if(typeof lFeature.bindPopup!=="undefined"&&feature.popup&&feature.popup.value){const popup_options=feature.popup.options?JSON.parse(feature.popup.options):{};lFeature.bindPopup(feature.popup.value,popup_options);}};Drupal.Leaflet.prototype.feature_bind_tooltip=function(lFeature,feature){if(feature.tooltip&&feature.tooltip.value.replace(/(<([^>]+)>)/gi,"").trim().length>0){const tooltip_options=feature.tooltip.options?JSON.parse(feature.tooltip.options):{};lFeature.bindTooltip(feature.tooltip.value,tooltip_options);}};Drupal.Leaflet.prototype.set_feature_path_style=function(lFeature,feature){const lFeature_path_style=feature.path?(feature.path instanceof Object?feature.path:JSON.parse(feature.path)):{};if(lFeature_path_style.hasOwnProperty('weight'))lFeature_path_style.weight=parseInt(lFeature_path_style.weight);lFeature.setStyle(lFeature_path_style);};Drupal.Leaflet.prototype.extend_map_bounds=function(lFeature,feature){if(feature.type==='point')this.bounds.push([feature.lat,feature.lon]);else{if(lFeature.getBounds)this.bounds.push(lFeature.getBounds().getSouthWest(),lFeature.getBounds().getNorthEast());}};Drupal.Leaflet.prototype.push_markers_features=function(lFeature,feature){if(feature['entity_id']){let entity_id=feature.entity_id;if(this.map_definition.geofield_cardinality&&this.map_definition.geofield_cardinality!==1){let i=0;while(this.markers[entity_id+'-'+i])i++;this.markers[entity_id+'-'+i]=lFeature;this.features[entity_id+'-'+i]=feature;}else{this.markers[entity_id]=lFeature;this.features[entity_id]=feature;}}};Drupal.Leaflet.prototype.create_geometry=function(feature,map_settings=false){let lFeature;switch(feature.type){case 'point':lFeature=this.create_point(feature);break;case 'linestring':lFeature=this.create_linestring(feature,map_settings?map_settings['leaflet_markercluster']['include_path']:false);break;case 'polygon':lFeature=this.create_polygon(feature,map_settings?map_settings['leaflet_markercluster']['include_path']:false);break;case 'multipolygon':lFeature=this.create_multipolygon(feature,map_settings?map_settings['leaflet_markercluster']['include_path']:false);break;case 'multipolyline':lFeature=this.create_multipoly(feature,map_settings?map_settings['leaflet_markercluster']['include_path']:false);break;case 'json':lFeature=this.create_json(feature.json,feature.options,feature.events);break;case 'multipoint':case 'geometrycollection':lFeature=this.create_collection(feature);break;default:lFeature={};}return lFeature;};Drupal.Leaflet.prototype.create_feature=function(feature){const map_settings=this.map_settings??NULL;let lFeature=this.create_geometry(feature,map_settings);this.feature_bind_tooltip(lFeature,feature);this.feature_bind_popup(lFeature,feature);if(lFeature.setStyle)this.set_feature_path_style(lFeature,feature);this.extend_map_bounds(lFeature,feature);this.push_markers_features(lFeature,feature);return lFeature;};Drupal.Leaflet.prototype.create_layer=function(layer,key){let self=this;let map_layer;const layer_type=layer.type??'base';const urlTemplate=layer.urlTemplate??'';const layer_options=layer.options??{};switch(layer_type){case 'wms':map_layer=new L.tileLayer.wms(urlTemplate,layer_options);break;case 'vector':map_layer=new L.maplibreGL({'style':urlTemplate,'attribution':layer_options.attribution??'','pitch':layer_options.pitch??'','bearing':layer_options.bearing??''});break;default:map_layer=new L.tileLayer(urlTemplate,layer_options);}map_layer._leaflet_id=key;if(layer.type==='tilestream')map_layer.getTileUrl=function(tilePoint){self._adjustTilePoint(tilePoint);let zoom=self._getZoomForUrl();return L.Util.template(self._url,L.Util.extend({s:self._getSubdomain(tilePoint),z:zoom,x:tilePoint.x,y:Math.pow(2,zoom)-tilePoint.y-1},self.options));};return map_layer;};Drupal.Leaflet.prototype.create_icon=function(options){let icon_options={iconUrl:options.iconUrl};if(options.iconSize)icon_options.iconSize=new L.Point(parseInt(options.iconSize.x),parseInt(options.iconSize.y));if(options.iconAnchor&&options.iconAnchor.x&&options.iconAnchor.y)icon_options.iconAnchor=new L.Point(parseInt(options.iconAnchor.x),parseInt(options.iconAnchor.y));if(options.popupAnchor&&options.popupAnchor.x&&options.popupAnchor.y)icon_options.popupAnchor=new L.Point(parseInt(options.popupAnchor.x),parseInt(options.popupAnchor.y));if(options.shadowUrl)icon_options.shadowUrl=options.shadowUrl;if(options.shadowSize&&options.shadowSize.x&&options.shadowSize.y)icon_options.shadowSize=new L.Point(parseInt(options.shadowSize.x),parseInt(options.shadowSize.y));if(options.shadowAnchor&&options.shadowAnchor.x&&options.shadowAnchor.y)icon_options.shadowAnchor=new L.Point(parseInt(options.shadowAnchor.x),parseInt(options.shadowAnchor.y));if(options.className)icon_options.className=options.className;if(options.iconRetinaUrl)icon_options.iconRetinaUrl=options.iconRetinaUrl;return new L.Icon(icon_options);};Drupal.Leaflet.prototype.create_divicon=function(options){let html_class=options['html_class']||'';let icon=new L.DivIcon({html:options.html,className:html_class});if(options.iconSize)icon.options.iconSize=new L.Point(parseInt(options.iconSize.x,10),parseInt(options.iconSize.y,10));if(options.iconAnchor&&options.iconAnchor.x&&options.iconAnchor.y)icon.options.iconAnchor=new L.Point(parseInt(options.iconAnchor.x),parseInt(options.iconAnchor.y));if(options.popupAnchor&&options.popupAnchor.x&&options.popupAnchor.y)icon.options.popupAnchor=new L.Point(parseInt(options.popupAnchor.x),parseInt(options.popupAnchor.y));return icon;};Drupal.Leaflet.prototype.create_point=function(marker){const latLng=new L.LatLng(marker.lat,marker.lon);let lMarker;let marker_title='';if(marker.title)marker_title=marker.title.replace(/<[^>]*>/g,'').trim();else{if(marker.tooltip&&marker.tooltip.value)marker_title=marker.tooltip.value.replace(/<[^>]*>/g,'').trim();}let options={title:marker.title?marker_title:"",className:marker.className||'',alt:marker_title,group_label:marker.group_label??''};lMarker=new L.Marker(latLng,options);if(marker.icon)if(marker.icon.iconType&&marker.icon.iconType==='html'&&marker.icon.html){let icon=this.create_divicon(marker.icon);lMarker.setIcon(icon);}else if(marker.icon.iconType&&marker.icon.iconType==='circle_marker'){try{options=marker.icon.circle_marker_options?JSON.parse(marker.icon.circle_marker_options):{};options.radius=options.radius?parseInt(options['radius']):10;}catch(e){options={};}lMarker=new L.CircleMarker(latLng,options);}else{if(marker.icon.iconUrl){marker.icon.iconSize=marker.icon.iconSize||{};marker.icon.iconSize.x=marker.icon.iconSize.x||this.naturalWidth;marker.icon.iconSize.y=marker.icon.iconSize.y||this.naturalHeight;if(marker.icon.shadowUrl){marker.icon.shadowSize=marker.icon.shadowSize||{};marker.icon.shadowSize.x=marker.icon.shadowSize.x||this.naturalWidth;marker.icon.shadowSize.y=marker.icon.shadowSize.y||this.naturalHeight;}let icon=this.create_icon(marker.icon);lMarker.setIcon(icon);}}return lMarker;};Drupal.Leaflet.prototype.create_linestring=function(polyline,clusterable=false){let latlngs=[];for(let i=0;i<polyline.points.length;i++){let latlng=new L.LatLng(polyline.points[i].lat,polyline.points[i].lon);latlngs.push(latlng);}return clusterable?new L.PolylineClusterable(latlngs):new L.Polyline(latlngs);};Drupal.Leaflet.prototype.create_collection=function(collection){let layers=new L.featureGroup();for(let x=0;x<collection.component.length;x++)layers.addLayer(this.create_feature(collection.component[x]));return layers;};Drupal.Leaflet.prototype.create_polygon=function(polygon,clusterable=false){const coordinates=polygon.points??[];return clusterable?new L.PolygonClusterable(coordinates):new L.Polygon(coordinates);};Drupal.Leaflet.prototype.create_multipolygon=function(multipolygon,clusterable=false){const coordinates=multipolygon.points??[];return clusterable?new L.PolygonClusterable(coordinates):new L.Polygon(coordinates);};Drupal.Leaflet.prototype.create_multipoly=function(multipoly,clusterable=false){let polygons=[];for(let x=0;x<multipoly.component.length;x++){let latlngs=[];let polygon=multipoly.component[x];for(let i=0;i<polygon.points.length;i++){let latlng=new L.LatLng(polygon.points[i].lat,polygon.points[i].lon);latlngs.push(latlng);}polygons.push(latlngs);}if(multipoly.multipolyline)return clusterable?new L.PolylineClusterable(polygons):new L.Polyline(polygons);else return clusterable?new L.PolygonClusterable(polygons):new L.Polygon(polygons);};Drupal.Leaflet.prototype.create_json=function(json,options=[],events=[]){let lJSON=new L.GeoJSON();const self=this;lJSON.options.onEachFeature=function(feature,layer){for(let layer_id in layer._layers){for(let i in layer._layers[layer_id]._latlngs){}}if(feature.properties.style)layer.setStyle(feature.properties.style);if(feature.properties.leaflet_id)layer._leaflet_id=feature.properties.leaflet_id;self.feature_bind_tooltip(layer,feature.properties);self.feature_bind_popup(layer,feature.properties);for(const e in events){let layerParam={};layerParam[e]=eval(events[e]);layer.on(layerParam);}};for(const option in options)if(Object.prototype.hasOwnProperty.call(options,option))lJSON.options[option]=eval(options[option]);lJSON.addData(json);return lJSON;};Drupal.Leaflet.prototype.fitBounds=function(){let start_zoom=this.map_settings.zoom?this.map_settings.zoom:12;let start_center=this.map_settings.center?new L.LatLng(this.map_settings.center.lat,this.map_settings.center.lon):new L.LatLng(0,0);if(this.map_settings.map_position_force)this.lMap.setView(start_center,start_zoom);else{if(this.bounds.length===0)this.lMap.setView(start_center,start_zoom);else{const bounds=new L.LatLngBounds(this.bounds);const fitbounds_options=this.map_settings.fitbounds_options?JSON.parse(this.map_settings.fitbounds_options):{};this.lMap.fitBounds(bounds,fitbounds_options);start_center=bounds.getCenter();start_zoom=this.lMap.getBoundsZoom(bounds);if(this.bounds.length===1){this.lMap.setZoom(this.map_settings.zoom);start_zoom=this.map_settings.zoom;}}if(this.map_settings.hasOwnProperty('zoomFiner')&&parseInt(this.map_settings.zoomFiner)){start_zoom+=parseFloat(this.map_settings.zoomFiner);this.lMap.setView(start_center,start_zoom);}this.start_zoom=start_zoom;this.start_center=start_center;}};Drupal.Leaflet.prototype.map_reset=function(mapid){Drupal.Leaflet[mapid].reset_view_control._resetView();};L.PolylineClusterable=L.Polyline.extend({_originalInitialize:L.Polyline.prototype.initialize,initialize:function(bounds,options){this._originalInitialize(bounds,options);this._latlng=this.getBounds().getCenter();},getLatLng:function(){return this._latlng;},setLatLng:function(){}});L.PolygonClusterable=L.Polygon.extend({_originalInitialize:L.Polygon.prototype.initialize,initialize:function(bounds,options){this._originalInitialize(bounds,options);this._latlng=this.getBounds().getCenter();},getLatLng:function(){return this._latlng;},setLatLng:function(){}});})(jQuery,Drupal,drupalSettings);;
/* @license GPL-2.0-or-later https://raw.githubusercontent.com/jquery-form/form/master/LICENSE */
(function(factory){if(typeof define==='function'&&define.amd)define(['jquery'],factory);else if(typeof module==='object'&&module.exports)module.exports=function(root,jQuery){if(typeof jQuery==='undefined')if(typeof window!=='undefined')jQuery=require('jquery');else jQuery=require('jquery')(root);factory(jQuery);return jQuery;};else factory(jQuery);}(function($){'use strict';var rCRLF=/\r?\n/g;var feature={};feature.fileapi=$('<input type="file">').get(0).files!==undefined;feature.formdata=(typeof window.FormData!=='undefined');var hasProp=!!$.fn.prop;$.fn.attr2=function(){if(!hasProp)return this.attr.apply(this,arguments);var val=this.prop.apply(this,arguments);if((val&&val.jquery)||typeof val==='string')return val;return this.attr.apply(this,arguments);};$.fn.ajaxSubmit=function(options,data,dataType,onSuccess){if(!this.length){log('ajaxSubmit: skipping submit process - no element selected');return this;}var method,action,url,isMsie,iframeSrc,$form=this;if(typeof options==='function')options={success:options};else if(typeof options==='string'||(options===false&&arguments.length>0)){options={'url':options,'data':data,'dataType':dataType};if(typeof onSuccess==='function')options.success=onSuccess;}else{if(typeof options==='undefined')options={};}method=options.method||options.type||this.attr2('method');action=options.url||this.attr2('action');url=(typeof action==='string')?action.trim():'';url=url||window.location.href||'';if(url)url=(url.match(/^([^#]+)/)||[])[1];isMsie=/(MSIE|Trident)/.test(navigator.userAgent||'');iframeSrc=(isMsie&&/^https/i.test(window.location.href||''))?'javascript:false':'about:blank';options=$.extend(true,{url,success:$.ajaxSettings.success,type:method||$.ajaxSettings.type,iframeSrc},options);var veto={};this.trigger('form-pre-serialize',[this,options,veto]);if(veto.veto){log('ajaxSubmit: submit vetoed via form-pre-serialize trigger');return this;}if(options.beforeSerialize&&options.beforeSerialize(this,options)===false){log('ajaxSubmit: submit aborted via beforeSerialize callback');return this;}var traditional=options.traditional;if(typeof traditional==='undefined')traditional=$.ajaxSettings.traditional;var elements=[];var qx,a=this.formToArray(options.semantic,elements,options.filtering);if(options.data){var optionsData=typeof (options.data)==="function"?options.data(a):options.data;options.extraData=optionsData;qx=$.param(optionsData,traditional);}if(options.beforeSubmit&&options.beforeSubmit(a,this,options)===false){log('ajaxSubmit: submit aborted via beforeSubmit callback');return this;}this.trigger('form-submit-validate',[a,this,options,veto]);if(veto.veto){log('ajaxSubmit: submit vetoed via form-submit-validate trigger');return this;}var q=$.param(a,traditional);if(qx)q=(q?(q+'&'+qx):qx);if(options.type.toUpperCase()==='GET'){options.url+=(options.url.indexOf('?')>=0?'&':'?')+q;options.data=null;}else options.data=q;var callbacks=[];if(options.resetForm)callbacks.push(function(){$form.resetForm();});if(options.clearForm)callbacks.push(function(){$form.clearForm(options.includeHidden);});if(!options.dataType&&options.target){var oldSuccess=options.success||function(){};callbacks.push(function(data,textStatus,jqXHR){var successArguments=arguments,fn=options.replaceTarget?'replaceWith':'html';$(options.target)[fn](data).each(function(){oldSuccess.apply(this,successArguments);});});}else{if(options.success)if(Array.isArray(options.success))callbacks=callbacks.concat(options.success);else callbacks.push(options.success);}options.success=function(data,status,xhr){var context=options.context||this;for(var i=0,max=callbacks.length;i<max;i++)callbacks[i].apply(context,[data,status,xhr||$form,$form]);};if(options.error){var oldError=options.error;options.error=function(xhr,status,error){var context=options.context||this;oldError.apply(context,[xhr,status,error,$form]);};}if(options.complete){var oldComplete=options.complete;options.complete=function(xhr,status){var context=options.context||this;oldComplete.apply(context,[xhr,status,$form]);};}var fileInputs=$('input[type=file]:enabled',this).filter(function(){return $(this).val()!=='';});var hasFileInputs=fileInputs.length>0;var mp='multipart/form-data';var multipart=($form.attr('enctype')===mp||$form.attr('encoding')===mp);var fileAPI=feature.fileapi&&feature.formdata;log('fileAPI :'+fileAPI);var shouldUseFrame=(hasFileInputs||multipart)&&!fileAPI;var jqxhr;if(options.iframe!==false&&(options.iframe||shouldUseFrame))if(options.closeKeepAlive)$.get(options.closeKeepAlive,function(){jqxhr=fileUploadIframe(a);});else jqxhr=fileUploadIframe(a);else if((hasFileInputs||multipart)&&fileAPI)jqxhr=fileUploadXhr(a);else jqxhr=$.ajax(options);$form.removeData('jqxhr').data('jqxhr',jqxhr);for(var k=0;k<elements.length;k++)elements[k]=null;this.trigger('form-submit-notify',[this,options]);return this;function deepSerialize(extraData){var serialized=$.param(extraData,options.traditional).split('&');var len=serialized.length;var result=[];var i,part;for(i=0;i<len;i++){serialized[i]=serialized[i].replace(/\+/g,' ');part=serialized[i].split('=');result.push([decodeURIComponent(part[0]),decodeURIComponent(part[1])]);}return result;}function fileUploadXhr(a){var formdata=new FormData();for(var i=0;i<a.length;i++)formdata.append(a[i].name,a[i].value);if(options.extraData){var serializedData=deepSerialize(options.extraData);for(i=0;i<serializedData.length;i++)if(serializedData[i])formdata.append(serializedData[i][0],serializedData[i][1]);}options.data=null;var s=$.extend(true,{},$.ajaxSettings,options,{contentType:false,processData:false,cache:false,type:method||'POST'});if(options.uploadProgress)s.xhr=function(){var xhr=$.ajaxSettings.xhr();if(xhr.upload)xhr.upload.addEventListener('progress',function(event){var percent=0;var position=event.loaded||event.position;var total=event.total;if(event.lengthComputable)percent=Math.ceil(position/total*100);options.uploadProgress(event,position,total,percent);},false);return xhr;};s.data=null;var beforeSend=s.beforeSend;s.beforeSend=function(xhr,o){if(options.formData)o.data=options.formData;else o.data=formdata;if(beforeSend)beforeSend.call(this,xhr,o);};return $.ajax(s);}function fileUploadIframe(a){var form=$form[0],el,i,s,g,id,$io,io,xhr,sub,n,timedOut,timeoutHandle;var deferred=$.Deferred();deferred.abort=function(status){xhr.abort(status);};if(a)for(i=0;i<elements.length;i++){el=$(elements[i]);if(hasProp)el.prop('disabled',false);else el.removeAttr('disabled');}s=$.extend(true,{},$.ajaxSettings,options);s.context=s.context||s;id='jqFormIO'+new Date().getTime();var ownerDocument=form.ownerDocument;var $body=$form.closest('body');if(s.iframeTarget){$io=$(s.iframeTarget,ownerDocument);n=$io.attr2('name');if(!n)$io.attr2('name',id);else id=n;}else{$io=$('<iframe name="'+id+'" src="'+s.iframeSrc+'" />',ownerDocument);$io.css({position:'absolute',top:'-1000px',left:'-1000px'});}io=$io[0];xhr={aborted:0,responseText:null,responseXML:null,status:0,statusText:'n/a',getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(status){var e=(status==='timeout'?'timeout':'aborted');log('aborting upload... '+e);this.aborted=1;try{if(io.contentWindow.document.execCommand)io.contentWindow.document.execCommand('Stop');}catch(ignore){}$io.attr('src',s.iframeSrc);xhr.error=e;if(s.error)s.error.call(s.context,xhr,e,status);if(g)$.event.trigger('ajaxError',[xhr,s,e]);if(s.complete)s.complete.call(s.context,xhr,e);}};g=s.global;if(g&&$.active++===0)$.event.trigger('ajaxStart');if(g)$.event.trigger('ajaxSend',[xhr,s]);if(s.beforeSend&&s.beforeSend.call(s.context,xhr,s)===false){if(s.global)$.active--;deferred.reject();return deferred;}if(xhr.aborted){deferred.reject();return deferred;}sub=form.clk;if(sub){n=sub.name;if(n&&!sub.disabled){s.extraData=s.extraData||{};s.extraData[n]=sub.value;if(sub.type==='image'){s.extraData[n+'.x']=form.clk_x;s.extraData[n+'.y']=form.clk_y;}}}var CLIENT_TIMEOUT_ABORT=1;var SERVER_ABORT=2;function getDoc(frame){var doc=null;try{if(frame.contentWindow)doc=frame.contentWindow.document;}catch(err){log('cannot get iframe.contentWindow document: '+err);}if(doc)return doc;try{doc=frame.contentDocument?frame.contentDocument:frame.document;}catch(err){log('cannot get iframe.contentDocument: '+err);doc=frame.document;}return doc;}var csrf_token=$('meta[name=csrf-token]').attr('content');var csrf_param=$('meta[name=csrf-param]').attr('content');if(csrf_param&&csrf_token){s.extraData=s.extraData||{};s.extraData[csrf_param]=csrf_token;}function doSubmit(){var t=$form.attr2('target'),a=$form.attr2('action'),mp='multipart/form-data',et=$form.attr('enctype')||$form.attr('encoding')||mp;form.setAttribute('target',id);if(!method||/post/i.test(method))form.setAttribute('method','POST');if(a!==s.url)form.setAttribute('action',s.url);if(!s.skipEncodingOverride&&(!method||/post/i.test(method)))$form.attr({encoding:'multipart/form-data',enctype:'multipart/form-data'});if(s.timeout)timeoutHandle=setTimeout(function(){timedOut=true;cb(CLIENT_TIMEOUT_ABORT);},s.timeout);function checkState(){try{var state=getDoc(io).readyState;log('state = '+state);if(state&&state.toLowerCase()==='uninitialized')setTimeout(checkState,50);}catch(e){log('Server abort: ',e,' (',e.name,')');cb(SERVER_ABORT);if(timeoutHandle)clearTimeout(timeoutHandle);timeoutHandle=undefined;}}var extraInputs=[];try{if(s.extraData)for(var n in s.extraData)if(s.extraData.hasOwnProperty(n))if($.isPlainObject(s.extraData[n])&&s.extraData[n].hasOwnProperty('name')&&s.extraData[n].hasOwnProperty('value'))extraInputs.push($('<input type="hidden" name="'+s.extraData[n].name+'">',ownerDocument).val(s.extraData[n].value).appendTo(form)[0]);else extraInputs.push($('<input type="hidden" name="'+n+'">',ownerDocument).val(s.extraData[n]).appendTo(form)[0]);if(!s.iframeTarget)$io.appendTo($body);if(io.attachEvent)io.attachEvent('onload',cb);else io.addEventListener('load',cb,false);setTimeout(checkState,15);try{form.submit();}catch(err){var submitFn=document.createElement('form').submit;submitFn.apply(form);}}finally{form.setAttribute('action',a);form.setAttribute('enctype',et);if(t)form.setAttribute('target',t);else $form.removeAttr('target');$(extraInputs).remove();}}if(s.forceSync)doSubmit();else setTimeout(doSubmit,10);var data,doc,domCheckCount=50,callbackProcessed;function cb(e){if(xhr.aborted||callbackProcessed)return;doc=getDoc(io);if(!doc){log('cannot access response document');e=SERVER_ABORT;}if(e===CLIENT_TIMEOUT_ABORT&&xhr){xhr.abort('timeout');deferred.reject(xhr,'timeout');return;}if(e===SERVER_ABORT&&xhr){xhr.abort('server abort');deferred.reject(xhr,'error','server abort');return;}if(!doc||doc.location.href===s.iframeSrc)if(!timedOut)return;if(io.detachEvent)io.detachEvent('onload',cb);else io.removeEventListener('load',cb,false);var status='success',errMsg;try{if(timedOut)throw 'timeout';var isXml=s.dataType==='xml'||doc.XMLDocument||$.isXMLDoc(doc);log('isXml='+isXml);if(!isXml&&window.opera&&(doc.body===null||!doc.body.innerHTML))if(--domCheckCount){log('requeing onLoad callback, DOM not available');setTimeout(cb,250);return;}var docRoot=doc.body?doc.body:doc.documentElement;xhr.responseText=docRoot?docRoot.innerHTML:null;xhr.responseXML=doc.XMLDocument?doc.XMLDocument:doc;if(isXml)s.dataType='xml';xhr.getResponseHeader=function(header){var headers={'content-type':s.dataType};return headers[header.toLowerCase()];};if(docRoot){xhr.status=Number(docRoot.getAttribute('status'))||xhr.status;xhr.statusText=docRoot.getAttribute('statusText')||xhr.statusText;}var dt=(s.dataType||'').toLowerCase();var scr=/(json|script|text)/.test(dt);if(scr||s.textarea){var ta=doc.getElementsByTagName('textarea')[0];if(ta){xhr.responseText=ta.value;xhr.status=Number(ta.getAttribute('status'))||xhr.status;xhr.statusText=ta.getAttribute('statusText')||xhr.statusText;}else{if(scr){var pre=doc.getElementsByTagName('pre')[0];var b=doc.getElementsByTagName('body')[0];if(pre)xhr.responseText=pre.textContent?pre.textContent:pre.innerText;else{if(b)xhr.responseText=b.textContent?b.textContent:b.innerText;}}}}else{if(dt==='xml'&&!xhr.responseXML&&xhr.responseText)xhr.responseXML=toXml(xhr.responseText);}try{data=httpData(xhr,dt,s);}catch(err){status='parsererror';xhr.error=errMsg=(err||status);}}catch(err){log('error caught: ',err);status='error';xhr.error=errMsg=(err||status);}if(xhr.aborted){log('upload aborted');status=null;}if(xhr.status)status=((xhr.status>=200&&xhr.status<300)||xhr.status===304)?'success':'error';if(status==='success'){if(s.success)s.success.call(s.context,data,'success',xhr);deferred.resolve(xhr.responseText,'success',xhr);if(g)$.event.trigger('ajaxSuccess',[xhr,s]);}else{if(status){if(typeof errMsg==='undefined')errMsg=xhr.statusText;if(s.error)s.error.call(s.context,xhr,status,errMsg);deferred.reject(xhr,'error',errMsg);if(g)$.event.trigger('ajaxError',[xhr,s,errMsg]);}}if(g)$.event.trigger('ajaxComplete',[xhr,s]);if(g&&!--$.active)$.event.trigger('ajaxStop');if(s.complete)s.complete.call(s.context,xhr,status);callbackProcessed=true;if(s.timeout)clearTimeout(timeoutHandle);setTimeout(function(){if(!s.iframeTarget)$io.remove();else $io.attr('src',s.iframeSrc);xhr.responseXML=null;},100);}var toXml=$.parseXML||function(s,doc){if(window.ActiveXObject){doc=new ActiveXObject('Microsoft.XMLDOM');doc.async='false';doc.loadXML(s);}else doc=(new DOMParser()).parseFromString(s,'text/xml');return (doc&&doc.documentElement&&doc.documentElement.nodeName!=='parsererror')?doc:null;};var httpData=function(xhr,type,s){var ct=xhr.getResponseHeader('content-type')||'',xml=((type==='xml'||!type)&&ct.indexOf('xml')>=0),data=xml?xhr.responseXML:xhr.responseText;if(xml&&data.documentElement.nodeName==='parsererror')if($.error)$.error('parsererror');if(s&&s.dataFilter)data=s.dataFilter(data,type);if(typeof data==='string')if((type==='json'||!type)&&ct.indexOf('json')>=0)data=JSON.parse(data);else{if((type==='script'||!type)&&ct.indexOf('javascript')>=0)$.globalEval(data);}return data;};return deferred;}};$.fn.ajaxForm=function(options,data,dataType,onSuccess){if(typeof options==='string'||(options===false&&arguments.length>0)){options={'url':options,'data':data,'dataType':dataType};if(typeof onSuccess==='function')options.success=onSuccess;}options=options||{};options.delegation=options.delegation&&typeof $.fn.on==='function';if(!options.delegation&&this.length===0){var o={s:this.selector,c:this.context};if(!$.isReady&&o.s){log('DOM not ready, queuing ajaxForm');$(function(){$(o.s,o.c).ajaxForm(options);});return this;}log('terminating; zero elements found by selector'+($.isReady?'':' (DOM not ready)'));return this;}if(options.delegation){$(document).off('submit.form-plugin',this.selector,doAjaxSubmit).off('click.form-plugin',this.selector,captureSubmittingElement).on('submit.form-plugin',this.selector,options,doAjaxSubmit).on('click.form-plugin',this.selector,options,captureSubmittingElement);return this;}if(options.beforeFormUnbind)options.beforeFormUnbind(this,options);return this.ajaxFormUnbind().on('submit.form-plugin',options,doAjaxSubmit).on('click.form-plugin',options,captureSubmittingElement);};function doAjaxSubmit(e){var options=e.data;if(!e.isDefaultPrevented()){e.preventDefault();$(e.target).closest('form').ajaxSubmit(options);}}function captureSubmittingElement(e){var target=e.target;var $el=$(target);if(!$el.is('[type=submit],[type=image]')){var t=$el.closest('[type=submit]');if(t.length===0)return;target=t[0];}var form=target.form;form.clk=target;if(target.type==='image')if(typeof e.offsetX!=='undefined'){form.clk_x=e.offsetX;form.clk_y=e.offsetY;}else if(typeof $.fn.offset==='function'){var offset=$el.offset();form.clk_x=e.pageX-offset.left;form.clk_y=e.pageY-offset.top;}else{form.clk_x=e.pageX-target.offsetLeft;form.clk_y=e.pageY-target.offsetTop;}setTimeout(function(){form.clk=form.clk_x=form.clk_y=null;},100);}$.fn.ajaxFormUnbind=function(){return this.off('submit.form-plugin click.form-plugin');};$.fn.formToArray=function(semantic,elements,filtering){var a=[];if(this.length===0)return a;var form=this[0];var formId=this.attr('id');var els=(semantic||typeof form.elements==='undefined')?form.getElementsByTagName('*'):form.elements;var els2;if(els)els=$.makeArray(els);if(formId&&(semantic||/(Edge|Trident)\//.test(navigator.userAgent))){els2=$(':input[form="'+formId+'"]').get();if(els2.length)els=(els||[]).concat(els2);}if(!els||!els.length)return a;if(typeof (filtering)==="function")els=$.map(els,filtering);var i,j,n,v,el,max,jmax;for(i=0,max=els.length;i<max;i++){el=els[i];n=el.name;if(!n||el.disabled)continue;if(semantic&&form.clk&&el.type==='image'){if(form.clk===el){a.push({name:n,value:$(el).val(),type:el.type});a.push({name:n+'.x',value:form.clk_x},{name:n+'.y',value:form.clk_y});}continue;}v=$.fieldValue(el,true);if(v&&v.constructor===Array){if(elements)elements.push(el);for(j=0,jmax=v.length;j<jmax;j++)a.push({name:n,value:v[j]});}else if(feature.fileapi&&el.type==='file'){if(elements)elements.push(el);var files=el.files;if(files.length)for(j=0;j<files.length;j++)a.push({name:n,value:files[j],type:el.type});else a.push({name:n,value:'',type:el.type});}else{if(v!==null&&typeof v!=='undefined'){if(elements)elements.push(el);a.push({name:n,value:v,type:el.type,required:el.required});}}}if(!semantic&&form.clk){var $input=$(form.clk),input=$input[0];n=input.name;if(n&&!input.disabled&&input.type==='image'){a.push({name:n,value:$input.val()});a.push({name:n+'.x',value:form.clk_x},{name:n+'.y',value:form.clk_y});}}return a;};$.fn.formSerialize=function(semantic){return $.param(this.formToArray(semantic));};$.fn.fieldSerialize=function(successful){var a=[];this.each(function(){var n=this.name;if(!n)return;var v=$.fieldValue(this,successful);if(v&&v.constructor===Array)for(var i=0,max=v.length;i<max;i++)a.push({name:n,value:v[i]});else{if(v!==null&&typeof v!=='undefined')a.push({name:this.name,value:v});}});return $.param(a);};$.fn.fieldValue=function(successful){for(var val=[],i=0,max=this.length;i<max;i++){var el=this[i];var v=$.fieldValue(el,successful);if(v===null||typeof v==='undefined'||(v.constructor===Array&&!v.length))continue;if(Array.isArray(v))val=val.concat(v);else val.push(v);}return val;};$.fieldValue=function(el,successful){var n=el.name,t=el.type,tag=el.tagName.toLowerCase();if(typeof successful==='undefined')successful=true;if(successful&&(!n||el.disabled||t==='reset'||t==='button'||(t==='checkbox'||t==='radio')&&!el.checked||(t==='submit'||t==='image')&&el.form&&el.form.clk!==el||tag==='select'&&el.selectedIndex===-1))return null;if(tag==='select'){var index=el.selectedIndex;if(index<0)return null;var a=[],ops=el.options;var one=(t==='select-one');var max=(one?index+1:ops.length);for(var i=(one?index:0);i<max;i++){var op=ops[i];if(op.selected&&!op.disabled){var v=op.value;if(!v)v=(op.attributes&&op.attributes.value&&!(op.attributes.value.specified))?op.text:op.value;if(one)return v;a.push(v);}}return a;}return $(el).val().replace(rCRLF,'\r\n');};$.fn.clearForm=function(includeHidden){return this.each(function(){$('input,select,textarea',this).clearFields(includeHidden);});};$.fn.clearFields=$.fn.clearInputs=function(includeHidden){var re=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var t=this.type,tag=this.tagName.toLowerCase();if(re.test(t)||tag==='textarea')this.value='';else if(t==='checkbox'||t==='radio')this.checked=false;else if(tag==='select')this.selectedIndex=-1;else if(t==='file')if(/MSIE/.test(navigator.userAgent))$(this).replaceWith($(this).clone(true));else $(this).val('');else{if(includeHidden)if((includeHidden===true&&/hidden/.test(t))||(typeof includeHidden==='string'&&$(this).is(includeHidden)))this.value='';}});};$.fn.resetForm=function(){return this.each(function(){var el=$(this);var tag=this.tagName.toLowerCase();switch(tag){case 'input':this.checked=this.defaultChecked;case 'textarea':this.value=this.defaultValue;return true;case 'option':case 'optgroup':var select=el.parents('select');if(select.length&&select[0].multiple)if(tag==='option')this.selected=this.defaultSelected;else el.find('option').resetForm();else select.resetForm();return true;case 'select':el.find('option').each(function(i){this.selected=this.defaultSelected;if(this.defaultSelected&&!el[0].multiple){el[0].selectedIndex=i;return false;}});return true;case 'label':var forEl=$(el.attr('for'));var list=el.find('input,select,textarea');if(forEl[0])list.unshift(forEl[0]);list.resetForm();return true;case 'form':if(typeof this.reset==='function'||(typeof this.reset==='object'&&!this.reset.nodeType))this.reset();return true;default:el.find('form,input,label,select,textarea').resetForm();return true;}});};$.fn.enable=function(b){if(typeof b==='undefined')b=true;return this.each(function(){this.disabled=!b;});};$.fn.selected=function(select){if(typeof select==='undefined')select=true;return this.each(function(){var t=this.type;if(t==='checkbox'||t==='radio')this.checked=select;else{if(this.tagName.toLowerCase()==='option'){var $sel=$(this).parent('select');if(select&&$sel[0]&&$sel[0].type==='select-one')$sel.find('option').selected(false);this.selected=select;}}});};$.fn.ajaxSubmit.debug=false;function log(){if(!$.fn.ajaxSubmit.debug)return;var msg='[jquery.form] '+Array.prototype.join.call(arguments,'');if(window.console&&window.console.log)window.console.log(msg);else{if(window.opera&&window.opera.postError)window.opera.postError(msg);}}}));;
/* @license GPL-2.0-or-later https://www.drupal.org/licensing/faq */
(function($,Drupal,drupalSettings){Drupal.Views={};Drupal.Views.parseQueryString=function(query){const args={};if(query.includes('?'))query=query.substring(query.indexOf('?')+1);let pair;const pairs=query.split('&');for(let i=0;i<pairs.length;i++){pair=pairs[i].split('=');if(pair[0]!=='q')if(pair[1])args[decodeURIComponent(pair[0].replace(/\+/g,' '))]=decodeURIComponent(pair[1].replace(/\+/g,' '));else args[decodeURIComponent(pair[0].replace(/\+/g,' '))]='';}return args;};Drupal.Views.parseViewArgs=function(href,viewPath){const returnObj={};const path=Drupal.Views.getPath(href);const viewHref=Drupal.url(viewPath).substring(drupalSettings.path.baseUrl.length);if(viewHref&&path.startsWith(`${viewHref}/`)){returnObj.view_args=decodeURIComponent(path.substring(viewHref.length+1,path.length));returnObj.view_path=path;}return returnObj;};Drupal.Views.pathPortion=function(href){const protocol=window.location.protocol;if(href.startsWith(protocol))href=href.substring(href.indexOf('/',protocol.length+2));return href;};Drupal.Views.getPath=function(href){href=Drupal.Views.pathPortion(href);href=href.substring(drupalSettings.path.baseUrl.length,href.length);if(href.startsWith('?q='))href=href.substring(3,href.length);const chars=['#','?','&'];for(let i=0;i<chars.length;i++)if(href.includes(chars[i]))href=href.substring(0,href.indexOf(chars[i]));return href;};})(jQuery,Drupal,drupalSettings);;
(function($,Drupal,drupalSettings){Drupal.behaviors.ViewsAjaxView={};Drupal.behaviors.ViewsAjaxView.attach=function(context,settings){if(settings&&settings.views&&settings.views.ajaxViews){const {views:{ajaxViews}}=settings;Object.keys(ajaxViews||{}).forEach((i)=>{Drupal.views.instances[i]=new Drupal.views.ajaxView(ajaxViews[i]);});}};Drupal.behaviors.ViewsAjaxView.detach=(context,settings,trigger)=>{if(trigger==='unload')if(settings&&settings.views&&settings.views.ajaxViews){const {views:{ajaxViews}}=settings;Object.keys(ajaxViews||{}).forEach((i)=>{const selector=`.js-view-dom-id-${ajaxViews[i].view_dom_id}`;if($(selector,context).length){delete Drupal.views.instances[i];delete settings.views.ajaxViews[i];}});}};Drupal.views={};Drupal.views.instances={};Drupal.views.ajaxView=function(settings){const selector=`.js-view-dom-id-${settings.view_dom_id}`;this.$view=$(selector);let ajaxPath=drupalSettings.views.ajax_path;if(ajaxPath.constructor.toString().includes('Array'))ajaxPath=ajaxPath[0];let queryString=window.location.search||'';if(queryString!==''){queryString=queryString.slice(1).replace(/q=[^&]+&?|page=[^&]+&?|&?render=[^&]+/,'');if(queryString!=='')queryString=(/\?/.test(ajaxPath)?'&':'?')+queryString;}this.element_settings={url:ajaxPath+queryString,submit:settings,httpMethod:'GET',setClick:true,event:'click',selector,progress:{type:'fullscreen'}};this.settings=settings;this.$exposed_form=$(`form#views-exposed-form-${settings.view_name.replace(/_/g,'-')}-${settings.view_display_id.replace(/_/g,'-')}`);once('exposed-form',this.$exposed_form).forEach(this.attachExposedFormAjax.bind(this));once('ajax-pager',this.$view.filter(this.filterNestedViews.bind(this))).forEach(this.attachPagerAjax.bind(this));const selfSettings=$.extend({},this.element_settings,{event:'RefreshView',base:this.selector,httpMethod:'GET',element:this.$view.get(0)});this.refreshViewAjax=Drupal.ajax(selfSettings);};Drupal.views.ajaxView.prototype.attachExposedFormAjax=function(){const that=this;this.exposedFormAjax=[];$('input[type=submit], button[type=submit], input[type=image]',this.$exposed_form).not('[data-drupal-selector=edit-reset]').each(function(index){const selfSettings=$.extend({},that.element_settings,{base:$(this).attr('id'),element:this});that.exposedFormAjax[index]=Drupal.ajax(selfSettings);});};Drupal.views.ajaxView.prototype.filterNestedViews=function(){return !this.$view.parents('.view').length;};Drupal.views.ajaxView.prototype.attachPagerAjax=function(){this.$view.find('.js-pager__items a, th.views-field a, .attachment .views-summary a').each(this.attachPagerLinkAjax.bind(this));};Drupal.views.ajaxView.prototype.attachPagerLinkAjax=function(id,link){const $link=$(link);const viewData={};const href=$link.attr('href');$.extend(viewData,this.settings,Drupal.Views.parseQueryString(href),Drupal.Views.parseViewArgs(href,this.settings.view_base_path));const selfSettings=$.extend({},this.element_settings,{submit:viewData,base:false,element:link,httpMethod:'GET'});this.pagerAjax=Drupal.ajax(selfSettings);};})(jQuery,Drupal,drupalSettings);;
(function($,Drupal,drupalSettings){Drupal.AjaxCommands.prototype.viewsShowMore=function(ajax,response){const selector=response.selector||ajax.wrapper;const $wrapper=$(selector);const method=response.method||ajax.method;const appendAt=response.append_at||'';const effect=ajax.getEffect(response);const settings=response.settings||ajax.settings||drupalSettings;const currentViewId=selector.replace('.js-view-dom-id-','views_dom_id:');const focusable=['input:not([type="hidden"]):not([disabled])','select:not([disabled])','textarea:not([disabled])','a[href]','button:not([disabled])','[tabindex]:not(slot)','audio[controls]','video[controls]','[contenteditable]:not([contenteditable="false"])','details>summary:first-of-type','details'].join(',');let $newContent=$($.parseHTML(response.data,document,true));if($newContent.length){$newContent=Drupal.theme('ajaxWrapperNewContent',$newContent,ajax,response);const view=Drupal.views.instances[currentViewId];Drupal.detachBehaviors($wrapper.get(0),settings);once.remove('ajax-pager',view.$view);once.remove('exposed-form',view.$exposed_form);const headerSelector=response.options.header_selector;if(headerSelector&&settings.header)$(headerSelector).html(settings.header);const footerSelector=response.options.footer_selector;if(footerSelector&&settings.footer)$(footerSelector).html(settings.footer);const contentSelector=appendAt&&!response.options.content_selector?`.view-content ${appendAt}`:response.options.content_selector||'.view-content';const pagerSelector=response.options.pager_selector||'.pager-show-more';const $firstNewItem=$newContent.find(contentSelector).children().first();if(effect.showEffect!=='show'&&effect.showEffect!=='scrollToggle')$newContent.find(contentSelector).children().hide();const $contentArea=$wrapper.find(contentSelector);if(effect.showEffect==='scroll_fadeToggle'||effect.showEffect==='scrollToggle'){const oldHeight=$contentArea.addClass('clearfix').height();const oldItems=$contentArea.children().length;const newItems=$newContent.find(contentSelector).children().length;const newHeight=oldHeight+Math.ceil((oldHeight/oldItems)*newItems);if(effect.showEffect==='scroll_fadeToggle')$contentArea.height(newHeight);const positionTop=$contentArea.offset().top+oldHeight-response.scroll_offset;$('html, body').animate({scrollTop:positionTop},effect.showSpeed);}$wrapper.find(pagerSelector).replaceWith($newContent.find(pagerSelector));$contentArea[method]($newContent.find(contentSelector).children());if(effect.showEffect!=='show'&&effect.showEffect!=='scrollToggle'){if(effect.showEffect==='scroll_fadeToggle')effect.showEffect='fadeIn';$contentArea.children(':not(:visible)')[effect.showEffect](effect.showSpeed);$contentArea.queue(function(next){$(this).css('height','auto');next();});}if($firstNewItem.find(focusable).length)$firstNewItem.find(focusable).first().focus();else $firstNewItem.attr('tabindex','0').focus();$wrapper.trigger('viewsShowMore.newContent',$newContent.clone());Drupal.attachBehaviors($wrapper.get(0),settings);}};})(jQuery,Drupal,drupalSettings);;
